<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head lang="en-us">
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />
	
	<meta name="generator" content="Hugo 0.30.2" />

	<title>Usage &mdash; dep</title>

	<link rel="stylesheet" href="https://carolynvs.github.io/depdocs/css/alabaster.css" type="text/css" />
	<link rel="stylesheet" href="https://carolynvs.github.io/depdocs/css/custom.css" type="text/css" />
	<link rel="stylesheet" href="https://carolynvs.github.io/depdocs/css/pygments.css" type="text/css" />

	

	<link rel="shortcut icon" href="https://carolynvs.github.io/depdocs/favicon.ico" type="image/x-icon"/>
</head>


	<body role="document">
		<div class="document">
			<div class="documentwrapper">
				<div class="bodywrapper">
					<div class="body" role="main">
						
	<h1>Usage</h1>

	
		<nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#installing-dependencies">Installing dependencies</a></li>
<li><a href="#adding-a-dependency">Adding a dependency</a></li>
<li><a href="#changing-dependencies">Changing dependencies</a></li>
<li><a href="#checking-the-status-of-dependencies">Checking the status of dependencies</a></li>
<li><a href="#visualizing-dependencies">Visualizing dependencies</a>
<ul>
<li>
<ul>
<li><a href="#linux">Linux</a></li>
<li><a href="#macos">MacOS</a></li>
<li><a href="#windows">Windows</a></li>
</ul></li>
</ul></li>
<li><a href="#updating-dependencies">Updating dependencies</a></li>
<li><a href="#removing-dependencies">Removing dependencies</a></li>
<li><a href="#testing-changes-to-a-dependency">Testing changes to a dependency</a></li>
</ul></li>
</ul>
</nav>
	

	

<p>There is one main subcommand you will use: <code>dep ensure</code>. <code>ensure</code> first checks that <code>Gopkg.lock</code> is consistent with <code>Gopkg.toml</code> and the <code>import</code>s in your code. If any
changes are detected, <code>dep</code>&rsquo;s solver works out a new <code>Gopkg.lock</code>. Then, <code>dep</code> checks if the contents of <code>vendor/</code> are what <code>Gopkg.lock</code> (the new one if applicable, else the existing one) says it should be, and rewrites <code>vendor/</code> as needed to bring it into line.</p>

<p>In essence, <code>dep ensure</code> <a href="https://youtu.be/5LtMb090AZI?t=20m4s">works in two phases to keep four buckets of state in sync</a>:</p>

<p><img width="463" alt="states-flow" src="https://user-images.githubusercontent.com/21599/29223886-22dd2578-7e96-11e7-8b51-3637b9ddc715.png"></p>

<p><em>Note: until we ship <a href="https://github.com/golang/dep/issues/121">vendor verification</a>, we can&rsquo;t efficiently perform the <code>Gopkg.lock</code> &lt;-&gt; <code>vendor/</code> comparison, so <code>dep ensure</code> unconditionally regenerates all of <code>vendor/</code> to be safe.</em></p>

<p><code>dep ensure</code> is safe to run early and often. See the help text for more detailed
usage instructions.</p>

<pre><code class="language-sh">$ dep help ensure
</code></pre>

<h2 id="installing-dependencies">Installing dependencies</h2>

<p>(if your <code>vendor/</code> directory isn&rsquo;t <a href="docs/FAQ.md#should-i-commit-my-vendor-directory">checked in with your code</a>)</p>

<!-- may change with https://github.com/golang/dep/pull/489 -->

<pre><code class="language-sh">$ dep ensure
</code></pre>

<p>If a dependency already exists in your <code>vendor/</code> folder, dep will ensure it
matches the constraints from the manifest. If the dependency is missing from
<code>vendor/</code>, the latest version allowed by your manifest will be installed.</p>

<h2 id="adding-a-dependency">Adding a dependency</h2>

<pre><code class="language-sh">$ dep ensure -add github.com/foo/bar
</code></pre>

<p>This adds a version constraint to your <code>Gopkg.toml</code>, and updates <code>Gopkg.lock</code> and <code>vendor/</code>. Now, import and use the package in your code! âœ¨</p>

<p><code>dep ensure -add</code> has some subtle behavior variations depending on the project or package named, and the state of your tree. See <code>dep ensure -examples</code> for more information.</p>

<h2 id="changing-dependencies">Changing dependencies</h2>

<p>If you want to:</p>

<ul>
<li>Change the allowed <code>version</code>/<code>branch</code>/<code>revision</code></li>
<li>Switch to using a fork</li>
</ul>

<p>for one or more dependencies, do the following:</p>

<ol>
<li>Manually edit your <code>Gopkg.toml</code>.</li>

<li><p>Run</p>

<pre><code class="language-sh">$ dep ensure
</code></pre></li>
</ol>

<h2 id="checking-the-status-of-dependencies">Checking the status of dependencies</h2>

<p>Run <code>dep status</code> to see the current status of all your dependencies.</p>

<pre><code class="language-sh">$ dep status
PROJECT                             CONSTRAINT     VERSION        REVISION  LATEST
github.com/Masterminds/semver       branch 2.x     branch 2.x     139cc09   c2e7f6c
github.com/Masterminds/vcs          ^1.11.0        v1.11.1        3084677   3084677
github.com/armon/go-radix           *              branch master  4239b77   4239b77
</code></pre>

<p>On top of that, if you have added new imports to your project or modified <code>Gopkg.toml</code> without running <code>dep ensure</code> again, <code>dep status</code> will tell you there is a mismatch between <code>Gopkg.lock</code> and the current status of the project.</p>

<pre><code class="language-sh">$ dep status
Lock inputs-digest mismatch due to the following packages missing from the lock:

PROJECT                         MISSING PACKAGES
github.com/Masterminds/goutils  [github.com/Masterminds/goutils]

This happens when a new import is added. Run `dep ensure` to install the missing packages.
</code></pre>

<p>As <code>dep status</code> suggests, run <code>dep ensure</code> to update your lockfile. Then run <code>dep status</code> again, and the lock mismatch should go away.</p>

<h2 id="visualizing-dependencies">Visualizing dependencies</h2>

<p>Generate a visual representation of the dependency tree by piping the output of <code>dep status -dot</code> to <a href="http://www.graphviz.org/">graphviz</a>.</p>

<h4 id="linux">Linux</h4>

<pre><code>$ sudo apt-get install graphviz
$ dep status -dot | dot -T png | display
</code></pre>

<h4 id="macos">MacOS</h4>

<pre><code>$ brew install graphviz
$ dep status -dot | dot -T png | open -f -a /Applications/Preview.app
</code></pre>

<h4 id="windows">Windows</h4>

<pre><code>&gt; choco install graphviz.portable
&gt; dep status -dot | dot -T png -o status.png; start status.png
</code></pre>

<p align="center"><img src="images/status-graph.png"></p>

<h2 id="updating-dependencies">Updating dependencies</h2>

<p>Updating brings the version of a dependency in <code>Gopkg.lock</code> and <code>vendor/</code> to the latest version allowed by the constraints in <code>Gopkg.toml</code>.</p>

<p>You can update just a targeted subset of dependencies (recommended):</p>

<pre><code class="language-sh">$ dep ensure -update github.com/some/project github.com/other/project
$ dep ensure -update github.com/another/project
</code></pre>

<p>Or you can update all your dependencies at once:</p>

<pre><code class="language-sh">$ dep ensure -update
</code></pre>

<p>&ldquo;Latest&rdquo; means different things depending on the type of constraint in use. If you&rsquo;re depending on a <code>branch</code>, <code>dep</code> will update to the latest tip of that branch. If you&rsquo;re depending on a <code>version</code> using <a href="#semantic-versioning">a semver range</a>, it will update to the latest version in that range.</p>

<h2 id="removing-dependencies">Removing dependencies</h2>

<ol>
<li>Remove the <code>import</code>s and all usage from your code.</li>
<li>Remove <code>[[constraint]]</code> rules from <code>Gopkg.toml</code> (if any).</li>

<li><p>Run</p>

<pre><code class="language-sh">$ dep ensure
</code></pre></li>
</ol>

<h2 id="testing-changes-to-a-dependency">Testing changes to a dependency</h2>

<p>Making changes in your <code>vendor/</code> directory directly is not recommended, as dep
will overwrite any changes. Instead:</p>

<ol>
<li><p>Delete the dependency from the <code>vendor/</code> directory.</p>

<pre><code class="language-sh">rm -rf vendor/&lt;dependency&gt;
</code></pre></li>

<li><p>Add that dependency to your <code>GOPATH</code>, if it isn&rsquo;t already.</p>

<pre><code class="language-sh">$ go get &lt;dependency&gt;
</code></pre></li>

<li><p>Modify the dependency in <code>$GOPATH/src/&lt;dependency&gt;</code>.</p></li>

<li><p>Test, build, etc.</p></li>
</ol>

<p>Don&rsquo;t run <code>dep ensure</code> until you&rsquo;re done. <code>dep ensure</code> will reinstall the
dependency into <code>vendor/</code> based on your manifest, as if you were installing from
scratch.</p>

<p>This solution works for short-term use, but for something long-term, take a look
at <a href="https://github.com/GetStream/vg">virtualgo</a>.</p>

<p>To test out code that has been pushed as a new version, or to a branch or fork,
see <a href="#changing-dependencies">changing dependencies</a>.</p>



						
					</div>
				</div>
			</div>
			
			<div class="sphinxsidebar" role="navigation" aria-label="main navigation">
	<div class="sphinxsidebarwrapper">
		<p class="logo">
			<a href="https://carolynvs.github.io/depdocs/">
				<img class="logo" src="https://carolynvs.github.io/depdocs/images/logo.png" alt="Logo"/>
				<h1 class="logo logo-name"></h1>
			</a>
		</p>
		
		

		
		

		

<h3>Navigation</h3>
<ul>
	
	<li class="toctree-l1">
		<a class="reference internal" href="/depdocs/">dep</a>
	</li>
	
	<li class="toctree-l1">
		<a class="reference internal" href="/depdocs/setup/">Setup</a>
	</li>
	
	<li class="toctree-l1">
		<a class="reference internal" href="/depdocs/usage/">Usage</a>
	</li>
	
	<li class="toctree-l1">
		<a class="reference internal" href="/depdocs/faq/">FAQ</a>
	</li>
	
</ul>



		

	</div>
</div>
<div class="clearer"></div>
</div>
			<div class="footer">
	&copy; 2017 
	
</div>




			

			

			
		</div>
	</body>
</html>